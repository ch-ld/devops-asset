# 微信头像自动更换器

## 🎯 功能介绍

这是一个基于UI自动化的微信头像自动更换工具，可以：
- 每天自动根据星期几更换对应的微信头像
- 支持周一到周五工作日自动更换
- 通过模拟鼠标点击和键盘操作实现自动化
- 支持定时任务，无需手动干预

## 📋 使用前准备

### 1. 系统要求
- Windows 10/11
- Python 3.7+
- 微信桌面版（已登录）

### 2. 安装步骤

1. **安装Python依赖**
   ```bash
   双击运行 setup.bat
   ```
   或手动执行：
   ```bash
   pip install -r requirements.txt
   ```

2. **准备头像文件**
   - 在 `avatars` 文件夹中放入5张头像图片
   - 文件命名要求：
     - `monday.png` - 周一头像
     - `tuesday.png` - 周二头像  
     - `wednesday.png` - 周三头像
     - `thursday.png` - 周四头像
     - `friday.png` - 周五头像

## 🚀 使用方法

### 方法1：双击运行
```
双击 run.bat 文件
```

### 方法2：命令行运行
```bash
python auto_wechat_avatar.py
```

### 运行模式选择

程序启动后会询问运行模式：

**1. 立即测试模式**
- 立即执行一次头像更换
- 用于测试功能是否正常

**2. 定时运行模式**  
- 每天早上8点自动更换头像
- 程序在后台持续运行

## ⚙️ 配置说明

可以在 `auto_wechat_avatar.py` 文件顶部修改配置：

```python
# 头像文件夹
AVATAR_FOLDER = "avatars"

# 每天更换时间
CHANGE_TIME = "08:00"  

# 工作日头像映射
WEEKDAY_AVATARS = {
    0: "monday.png",     # 周一
    1: "tuesday.png",    # 周二
    2: "wednesday.png",  # 周三
    3: "thursday.png",   # 周四
    4: "friday.png",     # 周五
}
```

## 📝 使用注意事项

### ⚠️ 重要提醒
1. **运行时请勿操作鼠标键盘**，会干扰自动化操作
2. **确保微信桌面版已登录**且在正常状态
3. **建议在固定分辨率下使用**，避免坐标偏移
4. **首次使用建议先测试**，确认功能正常

### 🔧 故障排除

**问题1：找不到微信窗口**
- 确保微信桌面版已启动并登录
- 检查微信窗口标题是否为"微信"或"WeChat"

**问题2：点击位置不准确**
- 不同分辨率下坐标可能有偏差
- 可以调整代码中的坐标值

**问题3：头像上传失败**
- 检查头像文件格式（推荐PNG/JPG）
- 确保文件路径正确且文件存在

**问题4：程序运行中断**
- 检查是否有其他程序干扰
- 确保Python依赖已正确安装

## 🔄 工作原理

1. **窗口检测**：自动查找并激活微信窗口
2. **菜单导航**：通过快捷键或点击打开设置页面
3. **头像定位**：定位到头像设置区域
4. **文件上传**：自动选择并上传新头像文件
5. **确认保存**：完成头像更换流程

## 📅 定时任务

程序使用 `schedule` 库实现定时任务：
- 默认每天8:00执行
- 只在工作日（周一到周五）执行
- 程序需要保持运行状态

## 🛡️ 安全说明

- 本工具通过UI自动化实现，不涉及微信协议破解
- 不会获取或存储任何微信数据
- 仅模拟正常的用户操作行为
- 建议在个人设备上使用

## 📞 技术支持

如遇到问题，请检查：
1. Python版本是否符合要求
2. 依赖库是否正确安装
3. 微信是否正常运行
4. 头像文件是否按要求命名和存放

---

**免责声明**：本工具仅供学习和个人使用，使用者需自行承担使用风险。 
